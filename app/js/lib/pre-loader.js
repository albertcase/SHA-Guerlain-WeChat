(function(){"use strict";function t(t,e){var o=[],i=this.options;return i.onProgress&&t&&i.onProgress.call(this,t,e,this.completed.length),this.completed.length+this.errors.length===this.queue.length&&(o.push(this.completed),this.errors.length&&o.push(this.errors),i.onComplete.apply(this,o)),this}var e="addEventListener"in new Image,o=function(t,e){this.options={pipeline:!1,auto:!0,prefetch:!1,onComplete:function(){}},e&&"object"==typeof e&&this.setOptions(e),this.addQueue(t),this.queue.length&&this.options.auto&&this.processQueue()};o.prototype.setOptions=function(t){var e,o=this.options;for(e in t)t.hasOwnProperty(e)&&(o[e]=t[e]);return this},o.prototype.addQueue=function(t){return this.queue=t.slice(),this},o.prototype.reset=function(){return this.completed=[],this.errors=[],this},o.prototype.addEvents=function(o,i,n){var r=this,s=this.options,h=function(){e?(this.removeEventListener("error",u),this.removeEventListener("abort",u),this.removeEventListener("load",p)):this.onerror=this.onabort=this.onload=null},u=function(){h.call(this),r.errors.push(i),s.onError&&s.onError.call(r,i),t.call(r,i),s.pipeline&&r.loadNext(n)},p=function(){h.call(this),r.completed.push(i),t.call(r,i,this),s.pipeline&&r.loadNext(n)};e?(o.addEventListener("error",u,!1),o.addEventListener("abort",u,!1),o.addEventListener("load",p,!1)):(o.onerror=o.onabort=u,o.onload=p)},o.prototype.load=function(t,e){var o=new Image;return this.addEvents(o,t,e),o.src=t,this},o.prototype.loadNext=function(t){return t++,this.queue[t]&&this.load(this.queue[t],t),this},o.prototype.processQueue=function(){var t=0,e=this.queue,o=e.length;if(this.reset(),this.options.pipeline)this.load(e[0],0);else for(;o>t;++t)this.load(e[t],t);return this},"function"==typeof define&&define.amd?define(function(){return o}):this.preLoader=o}).call(this);